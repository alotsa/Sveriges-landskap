<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Sverigekartan</title>

  <!-- Egen CSS för styling -->
  <link rel="stylesheet" href="style.css">
  
  <!-- Leaflet CSS för kartan -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />

  <!-- SheetJS (xlsx) för att läsa/skriva Excel -->
  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>

  <!-- Turf.js för geospatiell analys (ex. punkt-i-polygon) -->
  <script src="https://cdn.jsdelivr.net/npm/@turf/turf@6.5.0/turf.min.js"></script>
</head>
<body>
  <h1>Sverigekartan</h1>
  
  <!-- Avsnitt för sökning av plats med ortnamn -->
  <div id="place-search">
    <input id="placeName" type="text" placeholder="Plats (t.ex. Stockholm)" />
    <button id="searchPlaceButton">Sök</button>
  </div>
  
  <br>
  
  <!-- Avsnitt för sökning av plats med koordinater -->
  <div id="search">
    <input id="latitude" type="text" placeholder="Latitud (t.ex. 62.0)" />
    <input id="longitude" type="text" placeholder="Longitud (t.ex. 15.0)" />
    <button id="searchButton">Sök</button>
  </div>
  
  <!-- Visar resultatlista från platssökning (Nominatim) -->
  <div id="results"></div>
  
  <br>
  
  <!-- Kartbehållare -->
  <div id="map"></div>
  
  <br>

<!-- Instruktioner för att ladda upp och bearbeta Excel-filer -->
<div id="geo-instructions">
  <h2>Hämta geodata från koordinater</h2>
  <p>Ladda upp en Excel-fil med koordinater och få tillbaka en fil där varje punkt kopplas till motsvarande län, landskap (eller lappmark) och kommun.</p>

  <h3>Så här gör du:</h3>
  <ol>
    <li>Välj din Excel-fil.</li>
    <li>Klicka på <strong>"Hämta geodata"</strong>.</li>
    <li>Den bearbetade filen laddas ner automatiskt.</li>
  </ol>
  
  <!-- Filuppladdning för Excel + knapp för att starta bearbetning -->
  <div id="excel-upload">
    <input type="file" id="excelFile" accept=".xlsx,.xls" />
    <button id="processBtn">Hämta geodata</button>
  </div>

  <h3>Filformat & krav</h3>
  <p>Filen du laddar upp ska vara i <strong>Excel-format</strong> (<code>.xlsx</code> eller <code>.xls</code>) och innehålla följande kolumner:</p>

  <table>
    <tbody>
      <tr>
        <td><code>id</code> </td>
        <td>Unikt rad-ID (t.ex. katalognummer, accessionsnummer; <em>valfritt)</em></td>
      </tr>
      <tr>
        <td><code>lat</code></td>
        <td>Latitud i decimaltal (WGS84).</td>
      </tr>
      <tr>
        <td><code>lon</code></td>
        <td>Longitud i decimaltal (WGS84).</td>
      </tr>
    </tbody>
  </table>

  <p><strong>Viktigt:</strong></p>
  <ul>
    <li>Kolumnnamnen måste skrivas exakt som ovan (små bokstäver).</li>
    <li>Decimaler ska anges med punkt (<code>.</code>), inte komma (<code>,</code>).</li>
  </ul>

  <h2>Datakällor</h2>
  <p>Bakgrundskartan kommer från OpenStreetMap. Information om adress, kommun och län hämtas via Nominatims geokodningstjänst.</p>
  <p>Lagren som kan tändas och släckas i kartan baseras på:</p>
  <ul>
    <li>Län: Lantmäteriets Sverigekartor</li>
    <li>Kommun: Lantmäteriets Sverigekartor</li>
    <li>Landskap: Lantmäteriets distriktsindelning</li>
    <li>Lappmarkerna är avgränsade med hjälp av kommungränser</li>
  </ul>
  <p>Information om län och kommun kan skilja sig mellan OpenStreetMap/Nominatim och Lantmäteriets data, särskilt om punkten ligger mycket nära en gräns.</p>
  <p>När du hämtar geodata baseras län och kommun på data från Lantmäteriet, inte OpenStreetMap.</p>
</div>

<br>

  <!-- Leaflet JS för kartfunktionalitet -->
  <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>

  <!-- Din egen JavaScript som innehåller kart-logik, Excel-bearbetning osv. -->
  <script src="script.js"></script>
</body>
</html>
